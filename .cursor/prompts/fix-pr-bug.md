Fix the issues in this PR